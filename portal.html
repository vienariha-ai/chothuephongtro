<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>YT Home ‚Äì Portal t√†i kho·∫£n ph√≤ng</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background:
        radial-gradient(circle at top left, rgba(56, 189, 248, 0.2), transparent 50%),
        radial-gradient(circle at top right, rgba(129, 140, 248, 0.2), transparent 55%),
        radial-gradient(circle at bottom, rgba(45, 212, 191, 0.25), transparent 55%),
        #0b1120;
      color: #e5e7eb;
      min-height: 100vh;
      padding: 12px 16px 20px;
    }

    .container {
      width: 100%;
      max-width: 900px;
      margin: 0 auto;
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 16px;
      flex-wrap: wrap;
    }

    .logo-row {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .logo-icon {
      width: 32px;
      height: 32px;
      border-radius: 12px;
      background: conic-gradient(from 120deg, #38bdf8, #22c55e, #6366f1, #38bdf8);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 800;
      font-size: 1rem;
      color: #0b1120;
      box-shadow: 0 0 0 1px rgba(15, 23, 42, 0.8), 0 10px 30px rgba(15, 23, 42, 0.8);
    }

    .logo-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .logo-text-main {
      font-size: 1rem;
      font-weight: 700;
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }

    .logo-text-sub {
      font-size: 0.75rem;
      color: rgba(148, 163, 184, 0.9);
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .btn {
      border-radius: 999px;
      padding: 6px 12px;
      font-size: 0.8rem;
      font-weight: 600;
      border: 1px solid transparent;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      background: radial-gradient(circle at top left, #38bdf8, #2563eb);
      color: #f9fafb;
      box-shadow: 0 8px 22px rgba(37, 99, 235, 0.5);
      transition:
        transform 0.16s ease,
        box-shadow 0.16s ease,
        filter 0.16s ease;
      white-space: nowrap;
    }

    .btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 12px 28px rgba(37, 99, 235, 0.75);
      filter: brightness(1.03);
    }

    .btn-outline {
      background: transparent;
      border-color: rgba(148, 163, 184, 0.8);
      box-shadow: none;
      color: #e5e7eb;
    }

    .btn-outline:hover {
      background: rgba(15, 23, 42, 0.98);
      box-shadow: 0 10px 24px rgba(15, 23, 42, 0.98);
    }

    a {
      color: #38bdf8;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    .page-title {
      font-size: 1.2rem;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .page-subtitle {
      font-size: 0.85rem;
      color: rgba(148, 163, 184, 0.96);
      margin-bottom: 14px;
    }

    .grid {
      display: grid;
      grid-template-columns: 1.1fr 1fr;
      gap: 12px;
      margin-bottom: 14px;
    }

    .card {
      background: radial-gradient(circle at top left, rgba(15, 23, 42, 0.98), rgba(15, 23, 42, 0.99));
      border-radius: 16px;
      border: 1px solid rgba(148, 163, 184, 0.75);
      box-shadow: 0 16px 40px rgba(15, 23, 42, 1);
      padding: 12px;
      font-size: 0.85rem;
    }

    .card-title {
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 6px;
    }

    .badge {
      display: inline-block;
      font-size: 0.78rem;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.85);
      background: rgba(15, 23, 42, 0.96);
      margin-bottom: 4px;
    }

    .info-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-bottom: 4px;
    }

    .info-label {
      color: rgba(148, 163, 184, 0.96);
      font-size: 0.8rem;
    }

    .info-value {
      font-weight: 500;
      font-size: 0.85rem;
    }

    .list {
      margin-top: 4px;
      padding-left: 16px;
      font-size: 0.82rem;
      color: rgba(209, 213, 219, 0.96);
    }

    .list li {
      margin-bottom: 2px;
    }

    .small-note {
      font-size: 0.75rem;
      color: rgba(148, 163, 184, 0.96);
      margin-top: 6px;
    }

    .section-title {
      font-size: 0.95rem;
      font-weight: 600;
      margin-bottom: 6px;
      margin-top: 4px;
    }

    .table-like {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.8rem;
      margin-top: 4px;
    }

    .table-like th,
    .table-like td {
      padding: 6px 6px;
      border-bottom: 1px solid rgba(51, 65, 85, 0.9);
    }

    .table-like th {
      text-align: left;
      font-weight: 600;
      color: rgba(148, 163, 184, 0.98);
      font-size: 0.78rem;
    }

    .table-like td {
      color: rgba(229, 231, 235, 0.96);
    }

    @media (max-width: 768px) {
      .grid {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 480px) {
      body {
        padding: 10px 10px 18px;
      }

      .card {
        padding: 10px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="logo-row">
        <div class="logo-icon">YT</div>
        <div class="logo-text">
          <div class="logo-text-main">YT Home</div>
          <div class="logo-text-sub">Portal t√†i kho·∫£n ph√≤ng</div>
        </div>
      </div>
      <div class="header-actions">
        <a href="index.html" class="btn-outline" style="text-decoration:none;">Trang xem ph√≤ng</a>
        <button type="button" class="btn-outline" onclick="logoutTenant()">ƒêƒÉng xu·∫•t</button>
      </div>
    </header>

    <main>
      <div class="page-title">Xin ch√†o, c∆∞ d√¢n YT Home üè°</div>
      <div class="page-subtitle">
        D∆∞·ªõi ƒë√¢y l√† th√¥ng tin t·ªïng quan t√†i kho·∫£n ph√≤ng c·ªßa b·∫°n. C√≥ th·ªÉ m·ªü r·ªông ƒë·ªÉ hi·ªÉn th·ªã h·ª£p ƒë·ªìng, h√≥a ƒë∆°n, ch·ªâ s·ªë ƒëi·ªán n∆∞·ªõc...
      </div>

      <div class="grid">
        <!-- Th√¥ng tin t√†i kho·∫£n ph√≤ng -->
        <section class="card">
          <div class="card-title">Th√¥ng tin t√†i kho·∫£n ph√≤ng</div>
          <div class="badge" id="roomBadge">Ph√≤ng: --</div>

          <div class="info-row">
            <span class="info-label">Ph√≤ng:</span>
            <span class="info-value" id="roomLabel">--</span>
          </div>
          <div class="info-row">
            <span class="info-label">T√™n ch·ªß ph√≤ng:</span>
            <span class="info-value" id="tenantName">--</span>
          </div>
          <div class="info-row">
            <span class="info-label">ƒê·ªãnh danh (·∫©n b·ªõt):</span>
            <span class="info-value" id="tenantIdentity">--</span>
          </div>

          <div class="small-note">
            D·ªØ li·ªáu chi ti·∫øt c√≥ th·ªÉ ƒë∆∞·ª£c l·∫•y th√™m t·ª´ Apps Script (vd: action=tenantPortal) v√† render v√†o ƒë√¢y.
          </div>
        </section>

        <!-- Th√¥ng tin nhanh -->
        <section class="card">
          <div class="card-title">T√≥m t·∫Øt nhanh</div>
          <ul class="list">
            <li>Tr·∫°ng th√°i h·ª£p ƒë·ªìng: <strong id="contractStatus">ƒêang hi·ªáu l·ª±c (v√≠ d·ª•)</strong></li>
            <li>K·ª≥ thanh to√°n: <strong id="billingCycle">H√†ng th√°ng</strong></li>
            <li>H√¨nh th·ª©c thanh to√°n: <strong id="paymentMethod">Chuy·ªÉn kho·∫£n / ti·ªÅn m·∫∑t</strong></li>
          </ul>
          <div class="small-note">
            B·∫°n c√≥ th·ªÉ tu·ª≥ ch·ªânh ƒë·ªÉ hi·ªÉn th·ªã ƒë√∫ng theo d·ªØ li·ªáu t·ª´ Google Sheet (H·ª£p ƒë·ªìng, Thu chi...).
          </div>
        </section>
      </div>

      <!-- B·∫£ng v√≠ d·ª• h√≥a ƒë∆°n g·∫ßn ƒë√¢y -->
      <section class="card">
        <div class="section-title">H√≥a ƒë∆°n g·∫ßn ƒë√¢y (v√≠ d·ª• minh ho·∫°)</div>
        <table class="table-like">
          <thead>
            <tr>
              <th>K·ª≥</th>
              <th>M√¥ t·∫£</th>
              <th>S·ªë ti·ªÅn</th>
              <th>Tr·∫°ng th√°i</th>
            </tr>
          </thead>
          <tbody id="invoiceTableBody">
            <tr>
              <td>12/2025</td>
              <td>Ti·ªÅn ph√≤ng + ƒëi·ªán n∆∞·ªõc</td>
              <td>3.500.000 ƒë</td>
              <td>ƒê√£ thanh to√°n</td>
            </tr>
            <tr>
              <td>11/2025</td>
              <td>Ti·ªÅn ph√≤ng + ƒëi·ªán n∆∞·ªõc</td>
              <td>3.450.000 ƒë</td>
              <td>ƒê√£ thanh to√°n</td>
            </tr>
          </tbody>
        </table>
        <div class="small-note">
          Khi k·∫øt n·ªëi Apps Script, b·∫°n c√≥ th·ªÉ l·∫•y danh s√°ch h√≥a ƒë∆°n theo ph√≤ng (action=tenantInvoices ch·∫≥ng h·∫°n) v√† render v√†o b·∫£ng n√†y.
        </div>
      </section>
    </main>
  </div>

  <script>
    const TENANT_STORAGE_KEY = "ytHomeTenant";

    function logoutTenant() {
      try {
        localStorage.removeItem(TENANT_STORAGE_KEY);
      } catch (e) {
        console.error("logoutTenant error:", e);
      }
      window.location.href = "tenant.html";
    }

    function maskIdentity(identity) {
      if (!identity) return "--";
      const s = String(identity);
      if (s.length <= 4) return "***" + s;
      const last4 = s.slice(-4);
      return "**** " + last4;
    }

    document.addEventListener("DOMContentLoaded", () => {
      const params = new URLSearchParams(window.location.search);
      const roomParam = params.get("room");

      let tenant = null;
      try {
        const saved = localStorage.getItem(TENANT_STORAGE_KEY);
        if (saved) {
          tenant = JSON.parse(saved);
        }
      } catch (e) {
        console.error("read tenant error:", e);
      }

      if (!tenant || !tenant.maPhong) {
        // Ch∆∞a login ‚Üí quay v·ªÅ trang login
        window.location.href = "tenant.html";
        return;
      }

      // N·∫øu URL kh√¥ng c√≥ room ho·∫∑c room kh√°c ‚Üí ƒë·ªìng b·ªô l·∫°i
      if (!roomParam || roomParam !== tenant.maPhong) {
        const newUrl = "portal.html?room=" + encodeURIComponent(tenant.maPhong);
        window.history.replaceState({}, "", newUrl);
      }

      const roomBadge   = document.getElementById("roomBadge");
      const roomLabel   = document.getElementById("roomLabel");
      const tenantName  = document.getElementById("tenantName");
      const tenantIdEl  = document.getElementById("tenantIdentity");

      if (roomBadge) {
        roomBadge.textContent = "Ph√≤ng: " + tenant.maPhong;
      }
      if (roomLabel) {
        roomLabel.textContent = tenant.maPhong;
      }
      if (tenantName) {
        tenantName.textContent = tenant.name || "Ch·ªß ph√≤ng";
      }
      if (tenantIdEl) {
        tenantIdEl.textContent = maskIdentity(tenant.identity || "");
      }

      // N·∫øu sau n√†y c√≥ g·ªçi th√™m API (h·ª£p ƒë·ªìng, h√≥a ƒë∆°n...) th√¨ vi·∫øt ·ªü ƒë√¢y.
    });
  </script>
</body>
</html>
